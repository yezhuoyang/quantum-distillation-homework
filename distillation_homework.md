# Homework: Magic State and Bell-State Distillation

**Course:** Advanced Quantum Computing
**Due Date:** February 15, 2026

---

### Part 1: Introduction and Learning Objectives

In the era of Noisy Intermediate-Scale Quantum (NISQ) devices, managing and mitigating errors is the most significant challenge to unlocking the power of quantum computation. While full-scale quantum error correction remains a long-term goal, techniques to produce high-quality quantum states are critical for improving the reliability of current and near-term algorithms. 

This assignment focuses on two fundamental resource distillation protocols:
1.  **Bell-State Distillation:** A method for purifying entanglement between two parties, essential for quantum communication and networking.
2.  **Magic State Distillation:** A procedure for generating the high-fidelity non-Clifford states required for universal fault-tolerant quantum computation.

Through this assignment, you will gain hands-on experience with implementing cutting-edge quantum protocols, using advanced features of Qiskit like dynamic circuits, and confronting the real-world challenges of noise in quantum hardware.

**Learning Objectives:**
- Understand the theoretical principles behind entanglement and magic state distillation.
- Implement quantum protocols using **Qiskit Dynamic Circuits**, including mid-circuit measurements and classical control flow.
- Use **Quantum State Tomography (QST)** to experimentally reconstruct and verify quantum states.
- Execute experiments on real **IBM Quantum hardware** and analyze the impact of device noise on protocol performance.
- Critically evaluate whether a given quantum device operates below the noise threshold required for a distillation protocol to be effective.

### Part 2: Background Reading

Before you begin, please thoroughly read the following document, which provides the necessary theoretical background for both protocols and for the verification methods you will use.

- `distillation_explanation.md`

This document covers the "why" and "how" of the BBPSSW and 15-to-1 protocols, as well as an introduction to quantum state tomography.

### Part 3: Problem Set

For this assignment, you will be provided with three Python script templates to guide your implementation:
- `bbpssw_homework.py`: Template for the Bell-state distillation task.
- `magic_state_homework.py`: Template for the 15-to-1 magic state distillation task.
- `tomography_homework.py`: Template for the state tomography analysis.

You will need to complete the code in these files and use them to answer the questions below. Submit your completed Python files along with a final report presenting your circuits, data, and analysis.

---

#### **Problem 1: Bell-State Distillation (BBPSSW Protocol)**

In this problem, you will implement the BBPSSW entanglement distillation protocol. You will first simulate it and then run it on an IBM Quantum device to see how its performance is affected by real noise.

**Tasks:**

1.  **Implement the BBPSSW Circuit:**
    -   Open `bbpssw_homework.py`.
    -   Complete the `bbpssw_circuit()` function to construct the quantum circuit for the BBPSSW protocol as described in the background document. 
    -   The circuit should take two noisy Bell pairs as input and use mid-circuit measurements on the second pair to conditionally decide the success of the protocol.
    -   Use a classical register to store the measurement outcomes and another to flag whether the protocol was successful (i.e., the measurement outcomes matched).

2.  **Simulate the Protocol (Noiseless):**
    -   Run your completed script.
    -   The script will simulate your circuit on a local `AerSimulator`.
    -   **Question 1.1:** Draw your circuit using `qc.draw("mpl")` and include it in your report. Explain the role of each section of the circuit (state preparation, CNOT operations, measurement, and classical logic).
    -   **Question 1.2:** From the simulation results, what is the theoretical success probability of the protocol? How does this relate to the expected outcomes of the measurements on the target qubits?

3.  **Run on IBM Quantum Hardware:**
    -   The script is set up to connect to an IBM Quantum backend. Choose a device that supports dynamic circuits.
    -   Run the experiment on the real quantum device.
    -   **Question 1.3:** What is the success probability of the protocol on the real hardware? How does it compare to the ideal simulation? Explain any discrepancies, referencing potential sources of noise in the quantum device.

4.  **Verify the Distillation with State Tomography:**
    -   Open `tomography_homework.py`.
    -   You will perform two tomography experiments:
        a.  **Input State Tomography:** Perform QST on a single noisy Bell pair generated by your provider. This will establish your baseline fidelity.
        b.  **Output State Tomography:** Perform QST on the *output* of your BBPSSW protocol (i.e., the first qubit pair, conditioned on the protocol succeeding).
    -   **Question 1.4:** Report the fidelity of the initial noisy Bell state and the fidelity of the distilled output state. Include the reconstructed state plots (e.g., from `plot_state_city` or `plot_bloch_multivector`) in your report.
    -   **Question 1.5 (The Core Question):** Did the distillation protocol work? Is the fidelity of the output state significantly higher than the input state? Based on your results, is the quantum computer you used operating below the noise threshold required for this distillation protocol to be beneficial? Justify your answer with your data.

---

#### **Problem 2: Magic State Distillation (15-to-1 Protocol)**

Now, you will tackle the more complex 15-to-1 magic state distillation protocol. This protocol is significantly more sensitive to noise, and achieving a net fidelity improvement on current hardware is a major challenge.

**Tasks:**

1.  **Implement the 15-to-1 Circuit:**
    -   Open `magic_state_homework.py`.
    -   Complete the `magic_state_circuit()` function to build the 15-to-1 distillation circuit. Pay close attention to the specific pattern of the 15 T-gates as shown in the background reading; the order is critical.
    -   The circuit should initialize 5 qubits to the |+⟩ state, apply the T-gates, and then perform X-basis measurements on qubits 1-4.

2.  **Simulate the Protocol (Noiseless):**
    -   Run the script to simulate the ideal circuit.
    -   **Question 2.1:** Draw your full circuit and include it in your report. Given the complexity, you may need to break it into sections or use the `fold` parameter in `qc.draw()`.
    -   **Question 2.2:** In the ideal simulation, what is the success probability (i.e., the probability that all syndrome measurements are `0`)? What is the state of the output qubit (qubit 0) when the protocol succeeds? Compare the measurement probabilities of the output qubit to the theoretical amplitudes of the |T₀⟩ magic state.

3.  **Run on IBM Quantum Hardware:**
    -   Select a backend that supports dynamic circuits and has the lowest possible noise levels.
    -   Execute the 15-to-1 protocol on the chosen device.
    -   **Question 2.3:** What is the success probability on the real hardware? How does this compare to the ideal simulation? Given that this circuit has 15 T-gates and many CNOTs, discuss the expected impact of gate errors on the success rate.

4.  **Verify with State Tomography:**
    -   Use the `tomography_homework.py` script for this part.
    -   a. **Input State Tomography:** First, you need a baseline. The "input" to the protocol is a noisy T-state. On the real hardware, this is just a T-gate applied to a qubit. Perform QST on the state created by applying a single T-gate to a |+⟩ state on your chosen hardware. This represents your noisy input magic state.
    -   b. **Output State Tomography:** Perform QST on the output qubit (qubit 0) from your 15-to-1 circuit, conditioned on the protocol succeeding.
    -   **Question 2.4:** Report the fidelity of your initial noisy T-state and the fidelity of the distilled output magic state. Include the relevant state plots in your report.
    -   **Question 2.5 (The Core Question):** Did the 15-to-1 distillation protocol result in a higher fidelity magic state? The error suppression for this protocol is cubic (p_out ≈ 35p_in³). Given the input fidelity you measured, what output fidelity would you theoretically expect? How does your experimental result compare? Is the hardware you used anywhere near the threshold required to benefit from this protocol? Provide a detailed analysis.

### Part 4: Submission Guidelines

-   A single PDF report containing your answers to all questions, including the circuit diagrams and data plots.
-   Your three completed Python scripts: `bbpssw_homework.py`, `magic_state_homework.py`, and `tomography_homework.py`.
-   In your report, clearly label each question and provide both the result and a concise explanation of its significance.
-   Discuss the challenges you faced, particularly when running on real hardware, and how you might improve the experiments.
